<!DOCTYPE html>
<html lang="es">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <title>Marina & Jaime â€” 04.09.2027</title>
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
Â  Â Â 
Â  Â  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;1,400&family=Montserrat:wght@300;400;500;600&family=Fredoka+One&display=swap" rel="stylesheet">
Â  Â  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
Â  Â  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">

Â  Â  <style>
Â  Â  Â  Â  :root {
Â  Â  Â  Â  Â  Â  --pink: #ff7eb3;
Â  Â  Â  Â  Â  Â  --accent: #a68e74;Â 
Â  Â  Â  Â  Â  Â  --bg-color: #ededed;
Â  Â  Â  Â  Â  Â  --text-color: #2d2d2d;
Â  Â  Â  Â  Â  Â  --white: #ffffff;
Â  Â  Â  Â  Â  Â  --success: #d4edda;
Â  Â  Â  Â  Â  Â  --success-text: #155724;
Â  Â  Â  Â  }

Â  Â  Â  Â  * { box-sizing: border-box; margin: 0; padding: 0; }
Â  Â  Â  Â  html { scroll-behavior: smooth; }
Â  Â  Â  Â  body { font-family: 'Montserrat', sans-serif; background-color: var(--bg-color); color: var(--text-color); overflow-x: hidden; width: 100%; }

Â  Â  Â  Â  /* ================= FASE 1: LOS MINIJUEGES ================= */
Â  Â  Â  Â  #game-container {
Â  Â  Â  Â  Â  Â  position: fixed; inset: 0; z-index: 9999;
Â  Â  Â  Â  Â  Â  background: #fff8f2; display: flex; align-items: center; justify-content: center;
Â  Â  Â  Â  Â  Â  transition: opacity 0.6s ease-out;
Â  Â  Â  Â  Â  Â  touch-action: none;Â 
Â  Â  Â  Â  }
Â  Â  Â  Â  .screen {
Â  Â  Â  Â  Â  Â  display: none; flex-direction: column; align-items: center; justify-content: center;
Â  Â  Â  Â  Â  Â  width: 100%; height: 100%; text-align: center; padding: 25px; position: absolute;
Â  Â  Â  Â  }
Â  Â  Â  Â  .screen.active { display: flex; animation: fadeIn 0.5s forwards; }
Â  Â  Â  Â  @keyframes fadeIn { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }

Â  Â  Â  Â  h1.game-title { font-family: 'Fredoka One', cursive; color: var(--pink); font-size: 2.2rem; margin-bottom: 10px; }
Â  Â  Â  Â  p.romantic-text { font-style: italic; color: #777; margin-bottom: 25px; font-size: 1rem; max-width: 320px; line-height: 1.4; }
Â  Â  Â  Â  .instruction-text { font-size: 0.7rem; color: #aaa; margin-top: 25px; text-transform: uppercase; letter-spacing: 1px; }

Â  Â  Â  Â  .tinder-card { width: 280px; height: 400px; background: white; border-radius: 25px; box-shadow: 0 15px 35px rgba(0,0,0,0.1); border: 10px solid white; cursor: grab; position: relative; overflow: hidden; touch-action: none; }
Â  Â  Â  Â  .card-photo { width: 100%; height: 80%; background: #ffe3e3 url('https://via.placeholder.com/300x400?text=VUESTRA+FOTO') center/cover; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .handheld { width: 320px; height: 180px; background: #ff4757; border-radius: 30px; display: flex; padding: 15px; align-items: center; gap: 15px; box-shadow: 0 10px 0 #cc2e3b; }
Â  Â  Â  Â  .handheld button { width: 50px; height: 50px; border-radius: 50%; border: none; background: #2f3542; color: white; font-family: 'Fredoka One'; font-size: 1.2rem; cursor: pointer; touch-action: manipulation; }
Â  Â  Â  Â  .mini-screen { flex: 1; height: 130px; background: #7bed9f; position: relative; border: 5px solid #2f3542; overflow: hidden; border-radius: 10px; }
Â  Â  Â  Â  .pixel-car { position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%); font-size: 2.5rem; transition: bottom 0.2s; }

Â  Â  Â  Â  .bowling-lane { width: 240px; height: 320px; background: #f1f2f6; border-radius: 20px; position: relative; border-bottom: 15px solid #dfe4ea; overflow: hidden; }
Â  Â  Â  Â  .pins { display: flex; justify-content: center; gap: 12px; margin-top: 40px; font-size: 2.2rem; }
Â  Â  Â  Â  .bowling-ball-css { width: 55px; height: 55px; background: radial-gradient(circle at 30% 30%, #747d8c, #2f3542); border-radius: 50%; position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); cursor: pointer; transition: bottom 0.6s; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 8px rgba(0,0,0,0.2); }

Â  Â  Â  Â  .gym-bar { width: 260px; height: 35px; background: #f1f2f6; border-radius: 20px; border: 4px solid #ced4da; overflow: hidden; margin: 25px 0; }
Â  Â  Â  Â  #gym-fill { height: 100%; width: 0%; background: linear-gradient(90deg, #ff7eb3, #ff4757); transition: width 0.3s; }

Â  Â  Â  Â  .map-area { width: 330px; height: 330px; background: #70a1ff; border-radius: 30px; position: relative; border: 6px solid white; overflow: hidden; }
Â  Â  Â  Â  .italy-svg { position: absolute; right: 20px; top: 40px; width: 140px; fill: #eccc68; }
Â  Â  Â  Â  #plane { position: absolute; left: 20px; top: 150px; font-size: 3.2rem; cursor: move; z-index: 1000; touch-action: none; }

Â  Â  Â  Â  /* ================= TRANSICIÃ“N ================= */
Â  Â  Â  Â  #transition-stage { position: fixed; inset: 0; z-index: 10000; background: var(--bg-color); display: none; align-items: center; justify-content: center; pointer-events: none; opacity: 0; transition: opacity 0.5s ease-in-out; }
Â  Â  Â  Â  .envelope-wrapper { position: relative; width: 320px; height: 220px; perspective: 1200px; transform: translateZ(0); }
Â  Â  Â  Â  .envelope-lid { position: absolute; top: 0; left: 0; width: 100%; height: 50%; background: var(--accent); clip-path: polygon(0 0, 100% 0, 50% 50%); z-index: 30; transform-origin: top; transition: transform 0.8s cubic-bezier(0.4, 0, 0.2, 1); backface-visibility: hidden; }
Â  Â  Â  Â  .envelope-front { position: absolute; bottom: 0; left: 0; width: 100%; height: 100%; background: var(--accent); clip-path: polygon(0 100%, 100% 100%, 100% 0, 50% 50%, 0 0); z-index: 20; filter: brightness(0.9); backface-visibility: hidden; }
Â  Â  Â  Â  .card-inside { position: absolute; bottom: 5px; left: 5%; width: 90%; height: 95%; background: #fffdf5; z-index: 15; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 25px; text-align: center; border: 1px solid #ddd; box-shadow: 0 4px 10px rgba(0,0,0,0.1); transition: transform 1.2s cubic-bezier(0.19, 1, 0.22, 1); backface-visibility: hidden; will-change: transform; }
Â  Â  Â  Â  .envelope-wrapper.open .envelope-lid { transform: rotateX(180deg); z-index: 10; }
Â  Â  Â  Â  .envelope-wrapper.open .card-inside { transform: translate3d(0, -150px, 0) scale(1.05); }

Â  Â  Â  Â  /* ================= INVITACIÃ“N FINAL ================= */
Â  Â  Â  Â  #invitation-container { display: none; opacity: 0; transition: opacity 1s; position: relative; z-index: 1; touch-action: auto !important; }
Â  Â  Â  Â  .grain-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-image: url('Gemini_Generated_Image_32kd4932kd4932kd.jpg'); background-size: cover; background-position: center; filter: grayscale(100%) brightness(1.1) opacity(0.12); z-index: -2; pointer-events: none; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  h1, h2, h3, .serif { font-family: 'Playfair Display', serif; font-weight: 400; }
Â  Â  Â  Â  nav { position: fixed; top: 0; width: 100%; padding: 15px 0; background: rgba(237, 237, 237, 0.9); backdrop-filter: blur(12px); z-index: 1000; text-align: center; border-bottom: 1px solid rgba(0,0,0,0.05); overflow-x: auto; white-space: nowrap; -webkit-overflow-scrolling: touch; display: flex; justify-content: center; }
Â  Â  Â  Â  @media (max-width: 600px) { nav { justify-content: flex-start; padding: 15px 10px; } }
Â  Â  Â  Â  nav a { text-decoration: none; color: var(--text-color); margin: 0 15px; font-size: 0.65rem; text-transform: uppercase; letter-spacing: 2px; font-weight: 600; flex: 0 0 auto; pointer-events: auto !important; }

Â  Â  Â  Â  header.main-invitation-header { height: 75vh; width: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; background: linear-gradient(rgba(0,0,0,0.15), rgba(0,0,0,0.25)), url('foto_portada.jpg') center 70% / cover no-repeat; color: var(--white); padding: 20px; margin-top: 50px; }
Â  Â  Â  Â  header.main-invitation-header h1 { font-size: clamp(2.5rem, 8vw, 4rem); margin: 0; text-shadow: 0 4px 20px rgba(0,0,0,0.4); }

Â  Â  Â  Â  /* COUNTDOWN */
Â  Â  Â  Â  .countdown { display: flex; gap: 15px; margin-top: 25px; background: rgba(255,255,255,0.15); padding: 12px 20px; border-radius: 50px; backdrop-filter: blur(5px); border: 1px solid rgba(255,255,255,0.3); }
Â  Â  Â  Â  .count-item { display: flex; flex-direction: column; min-width: 40px; }
Â  Â  Â  Â  .count-item span:first-child { font-size: 1.2rem; font-weight: 600; }
Â  Â  Â  Â  .count-item span:last-child { font-size: 0.5rem; text-transform: uppercase; letter-spacing: 1px; opacity: 0.8; }

Â  Â  Â  Â  section.inv-section { max-width: 1100px; margin: 60px auto; padding: 0 20px; text-align: center; }
Â  Â  Â  Â  .section-title { font-size: 1.8rem; margin-bottom: 20px; }
Â  Â  Â  Â  .section-title::after { content: ""; display: block; width: 40px; height: 1px; background: var(--accent); margin: 10px auto; }
Â  Â  Â  Â  .story-text { max-width: 800px; margin: 30px auto; font-size: 1rem; line-height: 1.8; color: #444; text-align: center; }

Â  Â  Â  Â  /* TIMELINE */
Â  Â  Â  Â  .timeline-container { overflow-x: auto; -webkit-overflow-scrolling: touch; width: 100%; margin: 40px 0; scrollbar-width: none; }
Â  Â  Â  Â  .timeline-container::-webkit-scrollbar { display: none; }
Â  Â  Â  Â  .timeline-h { display: flex; justify-content: space-between; align-items: flex-start; position: relative; min-width: 800px; padding: 0 20px; }
Â  Â  Â  Â  .timeline-h::before { content: ""; position: absolute; top: 40px; left: 0; right: 0; height: 1px; background: var(--accent); opacity: 0.3; }
Â  Â  Â  Â  .timeline-h-item { flex: 1; text-align: center; position: relative; z-index: 2; }
Â  Â  Â  Â  .timeline-h-time { font-weight: 600; font-size: 0.85rem; color: var(--accent); display: block; margin-bottom: 12px; }
Â  Â  Â  Â  .timeline-h-dot { width: 11px; height: 11px; background: var(--accent); border-radius: 50%; margin: 0 auto 15px auto; border: 2px solid var(--bg-color); }

Â  Â  Â  Â  .carousel-outer { position: relative; overflow: hidden; width: 100%; margin: 30px 0; padding: 0 45px; }
Â  Â  Â  Â  .carousel-track { display: flex; overflow-x: auto; gap: 20px; scroll-behavior: smooth; -webkit-overflow-scrolling: touch; scroll-snap-type: x mandatory; scrollbar-width: none; }
Â  Â  Â  Â  .photo-card { min-width: 280px; height: 360px; object-fit: cover; border-radius: 4px; filter: grayscale(15%); scroll-snap-align: start; }
Â  Â  Â  Â  .msg-card { min-width: 300px; background: var(--white); padding: 30px; border-radius: 4px; text-align: left; border-left: 3px solid var(--accent); box-shadow: 0 8px 20px rgba(0,0,0,0.03); scroll-snap-align: start; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .carousel-btn { position: absolute; top: 50%; transform: translateY(-50%); width: 35px; height: 35px; border-radius: 50%; background: var(--white); border: 1px solid #eee; color: var(--accent); cursor: pointer; z-index: 10; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
Â  Â  Â  Â  .carousel-btn.prev { left: 5px; } .carousel-btn.next { right: 5px; }

Â  Â  Â  Â  .celebracion-info { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-top: 20px; }
Â  Â  Â  Â  @media (max-width: 768px) { .celebracion-info { grid-template-columns: 1fr; } }
Â  Â  Â  Â  .info-card { background: rgba(255,255,255,0.6); padding: 30px; border-radius: 12px; border: 1px solid rgba(0,0,0,0.05); text-align: left; box-shadow: 0 4px 20px rgba(0,0,0,0.02); }
Â  Â  Â  Â  .info-title { font-family: 'Playfair Display', serif; font-size: 1.2rem; color: var(--accent); font-weight: bold; margin-bottom: 15px; display: block; }
Â  Â  Â  Â  .bus-routes-list { list-style: none; padding: 0; margin-top: 10px; }
Â  Â  Â  Â  .bus-routes-list li { margin-bottom: 22px; font-size: 0.9rem; line-height: 1.6; border-left: 2px solid var(--accent); padding-left: 15px; }
Â  Â  Â  Â  .bus-routes-list b { color: var(--accent); display: block; text-transform: uppercase; font-size: 0.75rem; margin-bottom: 6px; letter-spacing: 1px; }

Â  Â  Â  Â  .tips-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-top: 30px; }
Â  Â  Â  Â  @media (max-width: 768px) { .tips-grid { grid-template-columns: 1fr; } }
Â  Â  Â  Â  .tip-item { padding: 20px; background: rgba(255,255,255,0.5); border-radius: 8px; text-align: center; }
Â  Â  Â  Â  .tip-item i { font-size: 1.8rem; color: var(--accent); margin-bottom: 10px; display: block; }

Â  Â  Â  Â  /* SECCIÃ“N FIESTA - DISEÃ‘O COMPACTO Y ALINEADO */
Â  Â  Â  Â  .party-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; max-width: 900px; margin: 30px auto; }
Â  Â  Â  Â  @media (max-width: 768px) { .party-grid { grid-template-columns: 1fr; gap: 20px; } }
Â  Â  Â  Â  .party-card { background: var(--white); padding: 20px 25px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.03); text-align: center; display: flex; flex-direction: column; align-items: center; }
Â  Â  Â  Â  .party-card i { font-size: 2.2rem; color: var(--accent); margin-bottom: 12px; display: block; }
Â  Â  Â  Â  .party-card h3 { font-family: 'Playfair Display', serif; font-size: 1.2rem; margin-bottom: 10px; }
Â  Â  Â  Â  .party-card p { font-size: 0.9rem; line-height: 1.9; color: #666; margin-bottom: 20px; }

Â  Â  Â  Â  /* BOTONES - ALINEACIÃ“N FLEX CORREGIDA */
Â  Â  Â  Â  .wa-button {Â 
Â  Â  Â  Â  Â  Â  background: white; border: 1px solid #ddd; padding: 12px 25px;Â 
Â  Â  Â  Â  Â  Â  text-decoration: none; color: var(--text-color); font-size: 0.7rem;Â 
Â  Â  Â  Â  Â  Â  text-transform: uppercase; font-weight: 600;Â 
Â  Â  Â  Â  Â  Â  display: inline-flex; align-items: center; justify-content: center;Â 
Â  Â  Â  Â  Â  Â  border-radius: 50px; transition: 0.3s;
Â  Â  Â  Â  Â  Â  gap: 10px; line-height: 1;
Â  Â  Â  Â  }
Â  Â  Â  Â  .wa-button i { font-size: 1.1rem; color: var(--accent); display: flex; align-items: center; margin: 0; }
Â  Â  Â  Â  .btn-accent { background: var(--accent); color: white !important; border: none; }
Â  Â  Â  Â  .btn-accent i { color: white !important; }

Â  Â  Â  Â  /* REGALO SUTIL */
Â  Â  Â  Â  .gift-card { background: var(--white); padding: 35px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.03); max-width: 600px; margin: 0 auto; border-top: 3px solid var(--accent); }
Â  Â  Â  Â  .gift-card p { line-height: 1.9; font-size: 0.95rem; color: #555; }
Â  Â  Â  Â  .iban-box { background: #f9f9f9; padding: 15px; border-radius: 8px; font-family: monospace; font-size: 1.1rem; letter-spacing: 1px; margin: 20px 0; border: 1px dashed #ccc; cursor: pointer; }

Â  Â  Â  Â  /* RSVP SECCIÃ“N ORIGINAL */
Â  Â  Â  Â  .rsvp-section { padding: 40px 20px; background: rgba(255,255,255,0.4); margin: 20px auto; border-radius: 4px; text-align: center; }
Â  Â  Â  Â  .btn-rsvp { background: var(--accent); color: white; border: none; padding: 18px 50px; font-size: 0.8rem; text-transform: uppercase; letter-spacing: 3px; cursor: pointer; border-radius: 4px; }

Â  Â  Â  Â  .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.85); display: none; justify-content: center; align-items: center; z-index: 30000; padding: 20px; }
Â  Â  Â  Â  .modal-body { width: 100%; max-width: 480px; max-height: 85vh; background: white; padding: 30px; border-radius: 8px; position: relative; overflow-y: auto; text-align: center; }
Â  Â  Â  Â  input, select, textarea { width: 100%; padding: 12px 0; margin-bottom: 12px; border: none; border-bottom: 1px solid #ddd; background: transparent; outline: none; font-family: inherit; font-size: 16px !important; }
Â  Â  Â  Â  .member-header { background: #fafafa; padding: 12px; display: flex; justify-content: space-between; align-items: center; cursor: pointer; font-weight: 600; color: var(--accent); font-size: 0.9rem; }
Â  Â  Â  Â  .member-header.completed { background: var(--success) !important; color: var(--success-text) !important; }
Â  Â  Â  Â  .member-content { padding: 15px; display: none; background: white; border-top: 1px solid #f0f0f0; }
Â  Â  Â  Â  .member-content.open { display: block; }
Â  Â  </style>
</head>
<body>

<div id="game-container">
Â  Â  <div class="screen active" id="game-s1">
Â  Â  Â  Â  <h1 class="game-title">Donde todo comenzÃ³... â¤ï¸</h1>
Â  Â  Â  Â  <p class="romantic-text">Un desliz a la derecha que nos cambiÃ³ la vida para siempre.</p>
Â  Â  Â  Â  <div class="tinder-card" id="tinderCard"><div class="card-photo"></div></div>
Â  Â  Â  Â  <p class="instruction-text">Desliza la tarjeta a la derecha</p>
Â  Â  </div>
Â  Â  <div class="screen" id="game-s2">
Â  Â  Â  Â  <h1 class="game-title">Nuestras viciadas ğŸ®</h1>
Â  Â  Â  Â  <p class="romantic-text">Entre partidas y piques sanos, nuestro amor no paraba de correr.</p>
Â  Â  Â  Â  <div class="handheld">
Â  Â  Â  Â  Â  Â  <button onpointerdown="drive(event)">A</button>
Â  Â  Â  Â  Â  Â  <div class="mini-screen"><div class="pixel-car" id="pCar">ğŸï¸</div></div>
Â  Â  Â  Â  Â  Â  <button onpointerdown="drive(event)">B</button>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <p class="instruction-text">Pulsa los botones A y B para avanzar</p>
Â  Â  </div>
Â  Â  <div class="screen" id="game-s3">
Â  Â  Â  Â  <h1 class="game-title">Â¡Pleno al corazÃ³n! Bowling ğŸ³</h1>
Â  Â  Â  Â  <p class="romantic-text">Esa tarde de bolos donde supimos que Ã©ramos el uno para el otro.</p>
Â  Â  Â  Â  <div class="bowling-lane" onpointerdown="shootBall()">
Â  Â  Â  Â  Â  Â  <div class="pins" id="pins">ğŸ³ ğŸ³ ğŸ³</div>
Â  Â  Â  Â  Â  Â  <div class="bowling-ball-css" id="ball"></div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <p class="instruction-text">Toca la pista para lanzar la bola</p>
Â  Â  </div>
Â  Â  <div class="screen" id="game-s4">
Â  Â  Â  Â  <h1 class="game-title">Juntos somos fuertes ğŸ’ª</h1>
Â  Â  Â  Â  <p class="romantic-text">Entrenando cuerpo y alma para el gran dÃ­a.</p>
Â  Â  Â  Â  <div style="font-size: 4rem;">ğŸ‹ï¸â€â™‚ï¸â¤ï¸ğŸ‹ï¸â€â™€ï¸</div>
Â  Â  Â  Â  <div class="gym-bar"><div id="gym-fill"></div></div>
Â  Â  Â  Â  <button class="btn-rsvp" onpointerdown="lift(event)" style="background:var(--pink); border-radius: 50px;">Â¡DAR FUERZA!</button>
Â  Â  </div>
Â  Â  <div class="screen" id="game-s5">
Â  Â  Â  Â  <h1 class="game-title">Rumbo a Italia... âœˆï¸</h1>
Â  Â  Â  Â  <p class="romantic-text">Bajo el cielo de Florencia...</p>
Â  Â  Â  Â  <div class="map-area" id="mapZone">
Â  Â  Â  Â  Â  Â  <svg class="italy-svg" viewBox="0 0 140 250"><path d="M34,44 L55,25 L78,21 L102,40 L97,64 L114,94 L125,127 L132,168 L126,192 L108,206 L94,226 L66,232 L58,212 L69,197 L65,178 L49,166 L45,138 L54,115 L46,90 L34,74 L34,44 Z" fill="#eccc68"/></svg>
Â  Â  Â  Â  Â  Â  <div id="plane">âœˆï¸</div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <p class="instruction-text">Arrastra el aviÃ³n hasta Italia</p>
Â  Â  </div>
Â  Â  <div class="screen" id="game-s6">
Â  Â  Â  Â  <h1 class="game-title">Â¡Lo logramos! ğŸ°</h1>
Â  Â  Â  Â  <p class="romantic-text">Madrid â” Aranjuez. El rincÃ³n perfecto.</p>
Â  Â  Â  Â  <div style="font-size: 4rem; margin: 20px 0;">ğŸ°ğŸ’ğŸš™</div>
Â  Â  Â  Â  <button class="btn-rsvp" onpointerdown="startTransition()" style="background:var(--pink); border-radius: 50px;">ABRIR INVITACIÃ“N ğŸ’Œ</button>
Â  Â  </div>
</div>

<div id="transition-stage">
Â  Â  <div class="envelope-wrapper" id="envelope">
Â  Â  Â  Â  <div class="envelope-lid"></div>
Â  Â  Â  Â  <div class="card-inside"><p>EstÃ¡s invitado/a</p><h2>MARINA & JAIME</h2><p>04.09.2027</p></div>
Â  Â  Â  Â  <div class="envelope-front"></div>
Â  Â  </div>
</div>

<div id="invitation-container">
Â  Â  <div class="grain-overlay"></div>
Â  Â  <nav>
Â  Â  Â  Â  <a href="#historia">Nosotros</a><a href="#galeria">Momentos</a><a href="#celebracion">CelebraciÃ³n</a><a href="#informacion">InformaciÃ³n</a><a href="#fiesta">Fiesta</a><a href="#regalo">Regalo</a><a href="#rsvp">Confirmar</a><a href="#recuerdos">Mensajes</a><a href="#contacto">Contacto</a>
Â  Â  </nav>
Â  Â Â 
Â  Â  <header class="main-invitation-header">
Â  Â  Â  Â  <h1>Marina & Jaime</h1>
Â  Â  Â  Â  <p>04 Â· Septiembre Â· 2027</p>
Â  Â  Â  Â  <div class="countdown" id="timer">
Â  Â  Â  Â  Â  Â  <div class="count-item"><span id="days">00</span><span>DÃ­as</span></div>
Â  Â  Â  Â  Â  Â  <div class="count-item"><span id="hours">00</span><span>Horas</span></div>
Â  Â  Â  Â  Â  Â  <div class="count-item"><span id="minutes">00</span><span>Mins</span></div>
Â  Â  Â  Â  </div>
Â  Â  </header>

Â  Â  <section class="inv-section" id="historia" data-aos="fade-up">
Â  Â  Â  Â  <h2 class="section-title">Nuestra Historia</h2>
Â  Â  Â  Â  <div class="story-text">Vuestra historia de amor comienza aquÃ­... una aventura que nos ha traÃ­do hasta este momento tan especial. Â¡Bienvenidos a nuestro gran dÃ­a!</div>
Â  Â  </section>

Â  Â  <section class="inv-section" id="galeria" data-aos="fade-up">
Â  Â  Â  Â  <h2 class="section-title">Momentos Juntos</h2>
Â  Â  Â  Â  <div class="carousel-outer">
Â  Â  Â  Â  Â  Â  <button class="carousel-btn prev" onpointerdown="scrollTrack('track-fotos', -1)"><i class="fas fa-chevron-left"></i></button>
Â  Â  Â  Â  Â  Â  <div class="carousel-track" id="track-fotos">
Â  Â  Â  Â  Â  Â  Â  Â  <img src="foto1.jpg" class="photo-card"><img src="foto2.jpg" class="photo-card"><img src="foto3.jpg" class="photo-card"><img src="foto4.jpg" class="photo-card"><img src="foto5.jpg" class="photo-card">
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <button class="carousel-btn next" onpointerdown="scrollTrack('track-fotos', 1)"><i class="fas fa-chevron-right"></i></button>
Â  Â  Â  Â  </div>
Â  Â  </section>

Â  Â  <section class="inv-section" id="celebracion" data-aos="fade-up">
Â  Â  Â  Â  <h2 class="section-title">CelebraciÃ³n</h2>
Â  Â  Â  Â  <div class="timeline-container">
Â  Â  Â  Â  Â  Â  <div class="timeline-h">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="timeline-h-item"><span class="timeline-h-time">19:30h</span><div class="timeline-h-dot"></div><span>Ceremonia</span></div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="timeline-h-item"><span class="timeline-h-time">20:00h</span><div class="timeline-h-dot"></div><span>CÃ³ctel</span></div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="timeline-h-item"><span class="timeline-h-time">21:30h</span><div class="timeline-h-dot"></div><span>Cena</span></div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="timeline-h-item"><span class="timeline-h-time">00:00h</span><div class="timeline-h-dot"></div><span>Fiesta</span></div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="timeline-h-item"><span class="timeline-h-time">04:00h</span><div class="timeline-h-dot"></div><span>Fin</span></div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="celebracion-info">
Â  Â  Â  Â  Â  Â  <div class="info-card">
Â  Â  Â  Â  Â  Â  Â  Â  <span class="info-title"><i class="fa-solid fa-bus"></i> Transporte Autobuses</span>
Â  Â  Â  Â  Â  Â  Â  Â  <ul class="bus-routes-list">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <li><b>Ida</b>Alameda (18:30h) â€” Hotel (18:50h) â€” Cubas</li>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <li><b>Vuelta 1</b>Cubas (00:45h) â€” Hotel (00:55h) â€” Alameda</li>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <li><b>Vuelta 2</b>Cubas (04:15h) â€” Hotel (04:25h) â€” Alameda</li>
Â  Â  Â  Â  Â  Â  Â  Â  </ul>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="info-card">
Â  Â  Â  Â  Â  Â  Â  Â  <span class="info-title"><i class="fa-solid fa-location-dot"></i> UbicaciÃ³n</span>
Â  Â  Â  Â  Â  Â  Â  Â  <p><b>Finca Las Bocas</b></p><p style="font-size: 0.9rem; color: #666;">28978 Cubas de la Sagra, Madrid</p>
Â  Â  Â  Â  Â  Â  Â  Â  <div style="height:150px; margin-top:10px; border-radius:8px; overflow:hidden;"><iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3051.848529235887!2d-3.8643886!3d40.1121974!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0xd4193eb774a123f%3A0xb3049b4c02f06b9!2sFinca%20El%20Olivar!5e0!3m2!1ses!2ses!4v1715850000000!5m2!1ses!2ses0" width="100%" height="100%" style="border:0;" allowfullscreen=""></iframe></div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </section>

Â  Â  <section class="inv-section" id="informacion" data-aos="fade-up">
Â  Â  Â  Â  <h2 class="section-title">Detalles importantes</h2>
Â  Â  Â  Â  <div class="tips-grid">
Â  Â  Â  Â  Â  Â  <div class="tip-item"><i class="fa-solid fa-shoe-prints"></i><h4>CÃ©sped</h4><p>Cenaremos al aire libre sobre el cÃ©sped. Recomendamos evitar tacones muy finos.</p></div>
Â  Â  Â  Â  Â  Â  <div class="tip-item"><i class="fa-solid fa-cloud-moon"></i><h4>Por si refresca</h4><p>Al caer el sol puede bajar la temperatura. Un chal serÃ¡ vuestro mejor aliado.</p></div>
Â  Â  Â  Â  Â  Â  <div class="tip-item"><i class="fa-solid fa-car"></i><h4>Parking</h4><p>La finca dispone de un amplio parking privado y gratuito para todos.</p></div>
Â  Â  Â  Â  </div>
Â  Â  </section>

Â  Â  <section class="inv-section" id="fiesta" data-aos="fade-up">
Â  Â  Â  Â  <h2 class="section-title">Vuestra Huella</h2>
Â  Â  Â  Â  <div class="party-grid">
Â  Â  Â  Â  Â  Â  <div class="party-card">
Â  Â  Â  Â  Â  Â  Â  Â  <i class="fa-solid fa-camera-retro"></i>
Â  Â  Â  Â  Â  Â  Â  Â  <h3>Ãlbum Digital</h3>
Â  Â  Â  Â  Â  Â  Â  Â  <p>Â¡Queremos recordar este dÃ­a a travÃ©s de vuestros ojos! Sube tus fotos favoritas aquÃ­.</p>
Â  Â  Â  Â  Â  Â  Â  Â  <a href="TU_ENLACE_ALBUM" target="_blank" class="wa-button btn-accent"><i class="fa-solid fa-cloud-arrow-up"></i>Subir fotos</a>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="party-card">
Â  Â  Â  Â  Â  Â  Â  Â  <i class="fa-solid fa-compact-disc"></i>
Â  Â  Â  Â  Â  Â  Â  Â  <h3>DJ Virtual</h3>
Â  Â  Â  Â  Â  Â  Â  Â  <p>Â¿QuÃ© temazo no puede faltar? DÃ­noslo en el formulario de confirmaciÃ³n.</p>
Â  Â  Â  Â  Â  Â  Â  Â  <a href="#rsvp" class="wa-button"><i class="fa-solid fa-music"></i>Pedir canciÃ³n</a>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </section>

Â  Â  <section class="inv-section" id="regalo" data-aos="fade-up">
Â  Â  Â  Â  <h2 class="section-title">Regalo</h2>
Â  Â  Â  Â  <div class="gift-card">
Â  Â  Â  Â  Â  Â  <p>Vuestra compaÃ±Ã­a es nuestro mejor regalo. No obstante, si deseÃ¡is tener un detalle con nosotros, os dejamos nuestra cuenta:</p>
Â  Â  Â  Â  Â  Â  <div class="iban-box" onclick="copyIBAN()">ES00 0000 0000 0000 0000 0000</div>
Â  Â  Â  Â  Â  Â  <p style="font-size: 0.7rem; color: #aaa;">Toca para copiar el nÃºmero de cuenta</p>
Â  Â  Â  Â  </div>
Â  Â  </section>

Â  Â  <section id="rsvp" class="rsvp-section" data-aos="zoom-in">
Â  Â  Â  Â  <h2 class="section-title">Â¿Contamos contigo?</h2>
Â  Â  Â  Â  <button class="btn-rsvp" onpointerdown="document.getElementById('rsvp-modal').style.display='flex'">Confirmar Asistencia</button>
Â  Â  </section>

Â  Â  <section class="inv-section" id="recuerdos" data-aos="fade-up">
Â  Â  Â  Â  <h2 class="section-title">Muro de Recuerdos</h2>
Â  Â  Â  Â  <div class="carousel-outer">
Â  Â  Â  Â  Â  Â  <button class="carousel-btn prev" onpointerdown="scrollTrack('track-muro', -1)"><i class="fas fa-chevron-left"></i></button>
Â  Â  Â  Â  Â  Â  <div class="carousel-track" id="track-muro"></div>
Â  Â  Â  Â  Â  Â  <button class="carousel-btn next" onpointerdown="scrollTrack('track-muro', 1)"><i class="fas fa-chevron-right"></i></button>
Â  Â  Â  Â  </div>
Â  Â  </section>

Â  Â  <section class="inv-section" id="contacto" data-aos="fade-up" style="margin-bottom: 80px;">
Â  Â  Â  Â  <h2 class="section-title">Contacto</h2>
Â  Â  Â  Â  <div style="display:flex; justify-content:center; gap:10px; flex-wrap:wrap;">
Â  Â  Â  Â  Â  Â  <a href="https://wa.me/34657141165" target="_blank" class="wa-button"><i class="fa-brands fa-whatsapp"></i> Marina</a>
Â  Â  Â  Â  Â  Â  <a href="https://wa.me/34600000000" target="_blank" class="wa-button"><i class="fa-brands fa-whatsapp"></i> Jaime</a>
Â  Â  Â  Â  </div>
Â  Â  </section>

Â  Â  <div id="rsvp-modal" class="modal-overlay">
Â  Â  Â  Â  <div class="modal-body">
Â  Â  Â  Â  Â  Â  <span style="position:absolute; top:15px; right:20px; cursor:pointer; font-size:1.5rem;" onpointerdown="document.getElementById('rsvp-modal').style.display='none'">Ã—</span>
Â  Â  Â  Â  Â  Â  <div id="global-spinner" class="spinner"></div>
Â  Â  Â  Â  Â  Â  <div id="step-1"><h2 class="serif">Busca tu invitaciÃ³n</h2><input type="text" id="input-busqueda" placeholder="Nombre o apellido" onkeyup="if(event.key === 'Enter') buscarNombres()"><button class="btn-rsvp" style="width:100%" onpointerdown="buscarNombres()">Buscar</button></div>
Â  Â  Â  Â  Â  Â  <div id="step-2" style="display:none;"><div id="lista-nombres"></div></div>
Â  Â  Â  Â  Â  Â  <div id="step-3" style="display:none;"><div id="lista-miembros"></div><button class="btn-rsvp" style="width:100%; margin-top:20px;" onpointerdown="enviarConfirmacion()" id="btn-enviar">Guardar Todo</button></div>
Â  Â  Â  Â  </div>
Â  Â  </div>
</div>

<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
<script>
Â  Â  let step = 1, lock = false, driveCount = 0;
Â  Â  const URL_API = "https://script.google.com/macros/s/AKfycbwO_rHe04Hx4aXdnDvVShYmC9EUqq_Ka3Q3CWQjhX_nL3S3opgWiroEs7qLnqI8QUqW/exec";

Â  Â  function updateTimer() {
Â  Â  Â  Â  const weddingDate = new Date("September 4, 2027 19:30:00").getTime();
Â  Â  Â  Â  const diff = weddingDate - new Date().getTime();
Â  Â  Â  Â  const d = Math.floor(diff / 86400000);
Â  Â  Â  Â  const h = Math.floor((diff % 86400000) / 3600000);
Â  Â  Â  Â  const m = Math.floor((diff % 3600000) / 60000);
Â  Â  Â  Â  if(document.getElementById("days")) {
Â  Â  Â  Â  Â  Â  document.getElementById("days").innerText = d < 10 ? "0"+d : d;
Â  Â  Â  Â  Â  Â  document.getElementById("hours").innerText = h < 10 ? "0"+h : h;
Â  Â  Â  Â  Â  Â  document.getElementById("minutes").innerText = m < 10 ? "0"+m : m;
Â  Â  Â  Â  }
Â  Â  }
Â  Â  setInterval(updateTimer, 60000); updateTimer();

Â  Â  function copyIBAN() { navigator.clipboard.writeText("ES00 0000 0000 0000 0000 0000"); alert("Copiado"); }

Â  Â  function next() {
Â  Â  Â  Â  if(lock) return; lock = true;
Â  Â  Â  Â  document.getElementById('game-s'+step).classList.remove('active');
Â  Â  Â  Â  step++; document.getElementById('game-s'+step).classList.add('active');
Â  Â  Â  Â  setTimeout(() => { lock = false; }, 800);
Â  Â  }

Â  Â  function scrollTrack(trackId, direction) {
Â  Â  Â  Â  const track = document.getElementById(trackId);
Â  Â  Â  Â  track.scrollBy({ left: direction * (track.clientWidth * 0.8), behavior: 'smooth' });
Â  Â  }

Â  Â  // JUEGOS
Â  Â  const tinder = document.getElementById('tinderCard'); let sX = 0;
Â  Â  const startTinder = (x) => {
Â  Â  Â  Â  if(step !== 1) return; sX = x;
Â  Â  Â  Â  const moveH = (ev) => {
Â  Â  Â  Â  Â  Â  if(sX === 0) return; let curX = ev.touches ? ev.touches[0].clientX : ev.clientX; let dist = curX - sX;
Â  Â  Â  Â  Â  Â  if(dist > 0) { tinder.style.transform = `translateX(${dist}px) rotate(${dist/15}deg)`; if(dist > 150) { sX = 0; cleanup(); next(); } }
Â  Â  Â  Â  };
Â  Â  Â  Â  const cleanup = () => { sX = 0; tinder.style.transform = ''; document.removeEventListener('mousemove', moveH); document.removeEventListener('touchmove', moveH); };
Â  Â  Â  Â  document.addEventListener('mousemove', moveH); document.addEventListener('touchmove', moveH, { passive: false });
Â  Â  Â  Â  window.addEventListener('mouseup', cleanup, { once: true }); window.addEventListener('touchend', cleanup, { once: true });
Â  Â  };
Â  Â  if(tinder) { tinder.onmousedown = (e) => startTinder(e.clientX); tinder.ontouchstart = (e) => startTinder(e.touches[0].clientX); }
Â  Â  function drive(e) { if(e) e.preventDefault(); driveCount++; document.getElementById('pCar').style.bottom = (10 + driveCount*10) + 'px'; if(driveCount >= 10) next(); }
Â  Â  function shootBall() { document.getElementById('ball').style.bottom = "240px"; setTimeout(() => { document.getElementById('pins').innerHTML = "ğŸ’¥ PLENO!"; setTimeout(next, 800); }, 500); }
Â  Â  let gymP = 0; function lift(e) { if(e) e.preventDefault(); gymP+=20; document.getElementById('gym-fill').style.width = gymP+'%'; if(gymP>=100) next(); }
Â  Â  const plane = document.getElementById('plane'); const mapZone = document.getElementById('mapZone'); let planeD = false;
Â  Â  function movePlaneLogic(clientX, clientY) {
Â  Â  Â  Â  if(!planeD || step !== 5) return; const rect = mapZone.getBoundingClientRect(); let x = clientX - rect.left - 25; let y = clientY - rect.top - 25;
Â  Â  Â  Â  plane.style.left = x + 'px'; plane.style.top = y + 'px'; if(x > 190 && y < 110) { planeD = false; next(); }
Â  Â  }
Â  Â  if(plane) {
Â  Â  Â  Â  plane.onmousedown = plane.ontouchstart = (e) => { planeD = true; if(e.cancelable) e.preventDefault(); };
Â  Â  Â  Â  window.addEventListener('mousemove', (e) => movePlaneLogic(e.clientX, e.clientY)); window.addEventListener('touchmove', (e) => movePlaneLogic(e.touches[0].clientX, e.touches[0].clientY), { passive: false });
Â  Â  Â  Â  window.addEventListener('mouseup', () => planeD = false); window.addEventListener('touchend', () => planeD = false);
Â  Â  }

Â  Â  function startTransition() {
Â  Â  Â  Â  const stage = document.getElementById('transition-stage'); const game = document.getElementById('game-container');
Â  Â  Â  Â  stage.style.display = 'flex'; requestAnimationFrame(() => { requestAnimationFrame(() => {
Â  Â  Â  Â  Â  Â  stage.style.opacity = '1'; setTimeout(() => { game.style.display = 'none'; document.getElementById('envelope').classList.add('open');
Â  Â  Â  Â  Â  Â  Â  Â  setTimeout(() => { stage.style.opacity = '0'; setTimeout(() => { stage.style.display = 'none'; revealFinalInvitation(); }, 550); }, 3200);
Â  Â  Â  Â  Â  Â  }, 700);
Â  Â  Â  Â  }); });
Â  Â  }

Â  Â  function revealFinalInvitation() { document.body.style.overflow = 'auto'; const inv = document.getElementById('invitation-container'); inv.style.display = 'block'; requestAnimationFrame(() => { inv.style.opacity = '1'; AOS.init({ duration: 1000, once: true }); cargarMuro(); }); }

Â  Â  // --- RSVP ---
Â  Â  async function buscarNombres() {
Â  Â  Â  Â  const bus = document.getElementById("input-busqueda").value.trim(); if(bus.length < 3) return; document.getElementById("global-spinner").style.display = "block";
Â  Â  Â  Â  try { const res = await fetch(`${URL_API}?action=search&nombre=${encodeURIComponent(bus)}`); const nombres = await res.json();
Â  Â  Â  Â  Â  Â  document.getElementById("step-1").style.display = "none"; document.getElementById("step-2").style.display = "block";
Â  Â  Â  Â  Â  Â  document.getElementById("lista-nombres").innerHTML = nombres.map(p => {Â 
Â  Â  Â  Â  Â  Â  Â  Â  const haRe = (p.asistencia === "SÃ­" || p.asistencia === "No");
Â  Â  Â  Â  Â  Â  Â  Â  return `<button class="btn-rsvp" style="width:100%; margin-bottom:10px; background:none; color:var(--accent); border:1px solid var(--accent);" onpointerdown="cargarGrupo('${p.id}')">${haRe ? 'âœ… ' : ''}${p.nombre}</button>`;Â 
Â  Â  Â  Â  Â  Â  }).join('');
Â  Â  Â  Â  } catch(e) { alert("Error"); } document.getElementById("global-spinner").style.display = "none";
Â  Â  }

Â  Â  let miembrosGrupo = [];
Â  Â  async function cargarGrupo(id) {
Â  Â  Â  Â  document.getElementById("step-2").style.display = "none"; document.getElementById("global-spinner").style.display = "block";
Â  Â  Â  Â  try { const res = await fetch(`${URL_API}?action=getGroup&groupId=${id}`); miembrosGrupo = await res.json();
Â  Â  Â  Â  Â  Â  let html = ""; miembrosGrupo.forEach((m, i) => {
Â  Â  Â  Â  Â  Â  Â  Â  const isCo = (m.asistencia === "SÃ­" || m.asistencia === "No");
Â  Â  Â  Â  Â  Â  Â  Â  html += `<div class="member-accordion">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="member-header ${isCo?'completed':''}" id="header-${i}" onpointerdown="toggleMember(${i})"><span>${m.nombre}</span> ${isCo?'<span>âœ… Confirmado</span>':'<span>Pendiente</span>'}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="member-content" id="content-${i}">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label>Â¿Asiste?</label><select class="sel-asistencia" onchange="checkStatus(${i})"><option value="Pendiente" ${(!isCo)?'selected':''}>Pendiente</option><option value="SÃ­" ${m.asistencia==='SÃ­'?'selected':''}>SÃ­</option><option value="No" ${m.asistencia==='No'?'selected':''}>No</option></select>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label>MenÃº</label><select class="sel-menu"><option value="Adulto" ${m.menu==='Adulto'?'selected':''}>Adulto</option><option value="NiÃ±o" ${m.menu==='NiÃ±o'?'selected':''}>NiÃ±o</option><option value="BebÃ©" ${m.menu==='BebÃ©'?'selected':''}>BebÃ©</option></select>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label>Bus Ida</label><select class="sel-bus-ida"><option value="No" ${(!m.bus_ida||m.bus_ida==='No')?'selected':''}>No</option><option value="SÃ­" ${m.bus_ida==='SÃ­'?'selected':''}>SÃ­</option></select>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label>Bus Vuelta</label><select class="sel-bus-vuelta"><option value="No" ${(!m.bus_vuelta||m.bus_vuelta==='No')?'selected':''}>No</option><option value="Vuelta 1 (00:45h)" ${m.bus_vuelta==='Vuelta 1 (00:45h)'?'selected':''}>Vuelta 1 (00:45h)</option><option value="Vuelta 2 (04:15h)" ${m.bus_vuelta==='Vuelta 2 (04:15h)'?'selected':''}>Vuelta 2 (04:15h)</option></select>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label>Alergias</label><textarea class="inp-alergia" placeholder="Ninguna" onpointerdown="event.stopPropagation()">${m.alergias||''}</textarea>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label>Tu canciÃ³n para el DJ</label><input type="text" class="inp-cancion" placeholder="Artista - TÃ­tulo" value="${m.cancion||''}">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label>Mensaje pÃºblico</label><textarea class="inp-mensaje-web" onpointerdown="event.stopPropagation()">${m.mensajeWeb||''}</textarea>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn-copy-settings" onpointerdown="copyToAll(${i})" style="margin-top:10px; background:none; border:1px dashed var(--accent); color:var(--accent); font-size:0.6rem; padding:6px 12px; cursor:pointer; text-transform:uppercase; border-radius:4px; width:100%;">Copiar a todos</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div></div>`;
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  document.getElementById("lista-miembros").innerHTML = html; document.getElementById("step-3").style.display = "block";
Â  Â  Â  Â  } catch(e) { alert("Error"); } document.getElementById("global-spinner").style.display = "none";
Â  Â  }

Â  Â  function toggleMember(i) { document.getElementById(`content-${i}`).classList.toggle('open'); }
Â  Â  function checkStatus(i) { const val = document.querySelectorAll('.sel-asistencia')[i].value; const header = document.getElementById(`header-${i}`); if(val !== "Pendiente") { header.classList.add('completed'); header.querySelector('span:last-child').innerHTML = "âœ… Listo"; } }
Â  Â Â 
Â  Â  function copyToAll(idx) {
Â  Â  Â  Â  const m = document.querySelectorAll('.sel-menu')[idx].value, bv = document.querySelectorAll('.sel-bus-vuelta')[idx].value, cn = document.querySelectorAll('.inp-cancion')[idx].value, mw = document.querySelectorAll('.inp-mensaje-web')[idx].value;
Â  Â  Â  Â  document.querySelectorAll('.sel-menu').forEach(s => s.value = m); document.querySelectorAll('.sel-bus-vuelta').forEach(s => s.value = bv); document.querySelectorAll('.inp-cancion').forEach(s => s.value = cn); document.querySelectorAll('.inp-mensaje-web').forEach(s => s.value = mw);
Â  Â  }

Â  Â  async function enviarConfirmacion() {
Â  Â  Â  Â  document.getElementById("global-spinner").style.display = "block";
Â  Â  Â  Â  const updates = miembrosGrupo.map((m, i) => ({ fila: m.fila, asistencia: document.querySelectorAll(".sel-asistencia")[i].value, menu: document.querySelectorAll(".sel-menu")[i].value, bus_ida: "SÃ­", bus_vuelta: document.querySelectorAll(".sel-bus-vuelta")[i].value, alergias: "", cancion: document.querySelectorAll(".inp-cancion")[i].value, mensajeWeb: document.querySelectorAll(".inp-mensaje-web")[i].value, mensajePrivado: "" }));
Â  Â  Â  Â  try { await fetch(URL_API, { method: "POST", body: JSON.stringify(updates) }); localStorage.setItem('bodaMarinaJaime_CONFIRMADO', 'true'); location.reload(); } catch(e) { alert("Error"); document.getElementById("global-spinner").style.display = "none"; }
Â  Â  }

Â  Â  async function cargarMuro() {
Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  const res = await fetch(`${URL_API}?action=getMessages`), data = await res.json(), track = document.getElementById("track-muro");
Â  Â  Â  Â  Â  Â  if(data && data.length > 0) {
Â  Â  Â  Â  Â  Â  Â  Â  const grouped = [];
Â  Â  Â  Â  Â  Â  Â  Â  data.forEach(m => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const txt = m.texto ? m.texto.trim() : ""; if(!txt || txt.toLowerCase() === "pendiente") return;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const existing = grouped.find(g => g.texto.toLowerCase() === txt.toLowerCase());
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const fullNombre = m.nombre ? m.nombre.trim() : "";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const primerNombre = fullNombre.split(' ')[0].trim();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if(existing) { if(primerNombre && !existing.nombresPila.includes(primerNombre)) existing.nombresPila.push(primerNombre); }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  else { grouped.push({ texto: txt, nombreOriginal: fullNombre, nombresPila: primerNombre ? [primerNombre] : [] }); }
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  track.innerHTML = grouped.map(g => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const names = g.nombresPila.filter(n => n.length > 0);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let firma = (names.length === 1) ? g.nombreOriginal : (names.length === 2) ? `${names[0]} y ${names[1]}` : `${names[0]} y familia`;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return `<div class="msg-card">"${g.texto}"<br><b>â€” ${firma}</b></div>`;
Â  Â  Â  Â  Â  Â  Â  Â  }).join('');
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  } catch(e) {}
Â  Â  }

Â  Â  document.body.style.overflow = 'hidden';
Â  Â  if(localStorage.getItem('bodaMarinaJaime_CONFIRMADO') === 'true') revealFinalInvitation();
</script>
</body>
</html>
